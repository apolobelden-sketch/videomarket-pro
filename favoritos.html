<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VideoMarket Pro - Favoritos</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Arial Rounded MT Bold', sans-serif;
            background: #000;
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
        }

        .header {
            width: 100%;
            padding: 10px;
            text-align: center;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid #333;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo-text { font-size: 18px; font-weight: bold; color: #fff; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }

        nav { display: flex; gap: 5px; }
        nav a { color: #fff; font-size: 9px; text-decoration: none; border: 1px solid #fff; padding: 4px 8px; border-radius: 15px; }

        .container {
            width: 100%;
            max-width: 450px;
            margin: 0 auto;
        }

        .product-item {
            position: relative;
            width: 100%;
            height: 100vh; 
            background: #000;
            scroll-snap-align: start;
            overflow: hidden;
            border-bottom: 2px solid #222;
        }

        /* Contenedor del Iframe de Cloudinary */
        .video-wrapper {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .info-box {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 60px 20px 40px 20px;
            background: linear-gradient(transparent, rgba(0,0,0,0.95));
            color: white;
            z-index: 10;
            pointer-events: none; /* Para que el click pase al video si tocan el texto */
        }

        .info-box * { pointer-events: auto; }

        .product-title { font-size: 19px; font-weight: bold; margin-bottom: 6px; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); }
        .product-promo { font-size: 13px; color: #ddd; margin-bottom: 18px; }

        .btn-buy {
            display: block;
            background: #0084ff; 
            color: white;
            text-decoration: none;
            padding: 16px;
            border-radius: 12px;
            font-weight: bold;
            text-align: center;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,132,255,0.3);
        }

        .whatsapp-float {
            position: fixed;
            bottom: 30px;
            right: 20px;
            background-color: #25d366;
            color: white;
            padding: 12px 18px;
            border-radius: 50px;
            text-decoration: none;
            font-size: 13px;
            font-weight: bold;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.6);
        }
    </style>
</head>
<body>

<header class="header">
    <div class="logo-text">âš¡ VIDEOMARKET PRO âš¡</div>
    <nav>
        <a href="index.html">ðŸ“š LIBROS</a>
        <a href="favoritos.html" style="background: #fff; color: #000;">ðŸ“± PREMIUM</a>
        <a href="ofertas.html" style="color: #25d366; border-color: #25d366;">âš¡ OFERTAS</a>
    </nav>
</header>

<div class="container" id="reels-container">
    </div>

<a href="https://wa.me/526311949491" class="whatsapp-float" target="_blank">
    <span>ðŸ’¬ Â¿Dudas? EscrÃ­benos</span>
</a>

<script>
    const productos = [
        { nombre: "Apple iPhone 16", id: "zwenhgzqb182lsu4ib59", promo: "ï£¿ Distribuidor Autorizado", link: "https://mercadolibre.com/sec/1J41orq" },
        { nombre: "Motorola Edge", id: "fix2f6y371azg8fwswcd", promo: "DiseÃ±o premium y velocidad pura.", link: "https://mercadolibre.com/sec/2WA6g3f" },
        { nombre: "Apple iPhone 17", id: "ct77tvoq0niyfq4wai8e", promo: "Lo mÃ¡s nuevo de Apple en tus manos.", link: "https://mercadolibre.com/sec/22L5iDv" },
        { nombre: "Galaxy Watch Ultra", id: "k1nsf8dohydcd0nn6whj", promo: "â›°ï¸ DiseÃ±ado para la aventura extrema.", link: "https://mercadolibre.com/sec/1un2Bf4" },
        { nombre: "Tablet C108 - 10.1\"", id: "k1tbnubjahpwcqo0tovc", promo: "Rendimiento ideal para el dÃ­a a dÃ­a.", link: "https://mercadolibre.com/sec/13rcPpB" },
        { nombre: "Sony WH-1000XM6", id: "ov0grqjnsjhos3pwihtj", promo: "ðŸŽµ Sonido de alta fidelidad.", link: "https://mercadolibre.com/sec/2TWPvDT" }
    ];

    const container = document.getElementById('reels-container');
    let hasInteracted = false;

    // Crear elementos
    productos.forEach((p, i) => {
        const item = document.createElement('div');
        item.className = 'product-item';
        item.dataset.vid = p.id;
        item.dataset.index = i;
        item.innerHTML = `
            <div class="video-wrapper" id="wrapper-${i}"></div>
            <div class="info-box">
                <h2 class="product-title">${p.nombre}</h2>
                <p class="product-promo">${p.promo}</p>
                <a href="${p.link}" class="btn-buy">Comprar ahora ></a>
            </div>
        `;
        container.appendChild(item);
    });

    // Observador para manejar el audio y la carga de Cloudinary
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const i = entry.target.dataset.index;
            const vid = entry.target.dataset.vid;
            const wrapper = document.getElementById(`wrapper-${i}`);

            if (entry.isIntersecting) {
                // Si el usuario ya interactuÃ³, los siguientes inician con audio (autoplay=true)
                const auto = hasInteracted ? "true" : "false";
                // Agregamos controls=true para que el usuario pueda quitar el Loop si gusta
                wrapper.innerHTML = `<iframe src="https://player.cloudinary.com/embed/?cloud_name=dgdw8fbku&public_id=${vid}&autoplay=${auto}&controls=true" allow="autoplay; fullscreen"></iframe>`;
            } else {
                // MUY IMPORTANTE: Borramos el iframe al salir de vista para que el audio muera al instante
                wrapper.innerHTML = "";
            }
        });
    }, { threshold: 0.5 });

    // Detectar interacciÃ³n para habilitar audio en los siguientes videos
    window.addEventListener('mousedown', () => { hasInteracted = true; }, { once: false });
    window.addEventListener('touchstart', () => { hasInteracted = true; }, { once: false });

    document.querySelectorAll('.product-item').forEach(item => observer.observe(item));
</script>

</body>
</html>
