<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VideoMarket Pro - Cloudinary</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Arial Rounded MT Bold', sans-serif;
            background: #000; overflow-y: scroll; scroll-snap-type: y mandatory;
        }
        .header {
            width: 100%; padding: 10px; text-align: center;
            background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(10px);
            position: fixed; top: 0; z-index: 100; border-bottom: 1px solid #333;
            display: flex; flex-direction: column; align-items: center; min-height: 90px;
        }
        .logo-text { font-size: 18px; font-weight: bold; color: #fff; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px;}
        nav { display: flex; gap: 5px; }
        nav a { color: #fff; font-size: 9px; text-decoration: none; border: 1px solid #fff; padding: 4px 8px; border-radius: 15px; }

        .container { width: 100%; max-width: 450px; margin: 0 auto; }

        .product-item {
            position: relative; width: 100%; height: 100vh; 
            background: #000; scroll-snap-align: start;
            overflow: hidden; border-bottom: 2px solid #222;
        }

        .video-wrapper { width: 100%; height: 100%; }
        iframe { width: 100%; height: 100%; border: none; }

        .info-box {
            position: absolute; bottom: 0; left: 0; width: 100%;
            padding: 50px 20px 30px 20px;
            background: linear-gradient(transparent, rgba(0,0,0,0.95));
            color: white; z-index: 10; pointer-events: none;
        }
        .info-box * { pointer-events: auto; }
        .product-title { font-size: 19px; font-weight: bold; margin-bottom: 6px; }
        .product-promo { font-size: 13px; color: #ddd; margin-bottom: 18px; }
        .btn-buy {
            display: block; background: #0084ff; color: white;
            text-decoration: none; padding: 16px; border-radius: 12px;
            font-weight: bold; text-align: center; font-size: 16px;
        }
        .whatsapp-float {
            position: fixed; bottom: 30px; right: 20px;
            background-color: #25d366; color: white; padding: 12px 18px;
            border-radius: 50px; text-decoration: none; font-size: 13px;
            font-weight: bold; z-index: 1000;
        }
    </style>
</head>
<body>

<header class="header">
    <div class="logo-text">âš¡ VIDEOMARKET PRO âš¡</div>
    <nav>
        <a href="#">ðŸ“š LIBROS</a>
        <a href="#">ðŸ“± PREMIUM</a>
        <a href="#" style="color: #25d366; border-color: #25d366;">âš¡ OFERTAS</a>
    </nav>
</header>

<div class="container" id="feed"></div>

<a href="https://wa.me/526311949491" class="whatsapp-float" target="_blank">
    <span>ðŸ’¬ Â¿Dudas? EscrÃ­benos</span>
</a>

<script>
    const productos = [
        { nombre: "Apple iPhone 16", id: "zwenhgzqb182lsu4ib59", promo: "GarantÃ­a Oficial Apple", link: "https://mercadolibre.com/sec/1J41orq" },
        { nombre: "Motorola Edge", id: "fix2f6y371azg8fwswcd", promo: "DiseÃ±o premium y velocidad.", link: "#" },
        { nombre: "Apple iPhone 17", id: "ct77tvoq0niyfq4wai8e", promo: "Lo mÃ¡s nuevo de Apple.", link: "#" },
        { nombre: "Galaxy Watch Ultra", id: "k1nsf8dohydcd0nn6whj", promo: "Resistencia extrema.", link: "#" },
        { nombre: "Tablet C108", id: "k1tbnubjahpwcqo0tovc", promo: "Pantalla de 10.1 pulgadas.", link: "#" },
        { nombre: "Sony WH-1000XM6", id: "ov0grqjnsjhos3pwihtj", promo: "CancelaciÃ³n de ruido lÃ­der.", link: "#" }
    ];

    const feed = document.getElementById('feed');
    let userHasClicked = false;

    productos.forEach((p, i) => {
        const item = document.createElement('div');
        item.className = 'product-item';
        item.dataset.vid = p.id;
        item.dataset.index = i;
        item.innerHTML = `
            <div class="video-wrapper" id="wrapper-${i}"></div>
            <div class="info-box">
                <h2 class="product-title">${p.nombre}</h2>
                <p class="product-promo">${p.promo}</p>
                <a href="${p.link}" class="btn-buy">Comprar ahora ></a>
            </div>
        `;
        feed.appendChild(item);
    });

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const i = entry.target.dataset.index;
            const vid = entry.target.dataset.vid;
            const wrapper = document.getElementById(`wrapper-${i}`);

            if (entry.isIntersecting) {
                // Una vez que el usuario da el primer Play, los siguientes cargan con autoplay
                const autoplay = userHasClicked ? "true" : "false";
                wrapper.innerHTML = `<iframe src="https://player.cloudinary.com/embed/?cloud_name=dgdw8fbku&public_id=${vid}&autoplay=${autoplay}&controls=true" allow="autoplay; fullscreen"></iframe>`;
            } else {
                // Borramos el video al salir para que el audio se corte de inmediato
                wrapper.innerHTML = "";
            }
        });
    }, { threshold: 0.5 });

    window.addEventListener('mousedown', () => { userHasClicked = true; }, { once: false });
    document.querySelectorAll('.product-item').forEach(item => observer.observe(item));
</script>

</body>
</html>
