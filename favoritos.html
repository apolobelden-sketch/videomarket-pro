<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CatÃ¡logo Interactivo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #000; color: white; font-family: sans-serif; 
            overflow-y: scroll; scroll-snap-type: y mandatory;
        }
        .contenedor-reels {
            position: relative; width: 100vw; height: 100vh;
            scroll-snap-align: start; display: flex; align-items: center; justify-content: center;
        }
        /* El reproductor con controles visibles */
        .reproductor { width: 100%; height: 100%; }
        
        .info {
            position: absolute; bottom: 110px; left: 20px; z-index: 10;
            pointer-events: none;
        }
        .boton-compra {
            position: absolute; bottom: 40px; left: 20px; right: 80px;
            background: #FFE600; color: #000; padding: 15px;
            text-align: center; text-decoration: none; font-weight: bold;
            border-radius: 10px; z-index: 10;
        }
        .whatsapp {
            position: fixed; bottom: 35px; right: 15px;
            background: #25d366; width: 55px; height: 55px;
            border-radius: 50%; display: flex; align-items: center;
            justify-content: center; z-index: 100;
        }
    </style>
</head>
<body>

<a href="https://wa.me/526311949491" class="whatsapp" target="_blank">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" width="35">
</a>

<div id="pantalla-reels"></div>

<script>
    const listaProductos = [
        { nombre: "iPhone 16", id: "zwenhgzqb182lsu4ib59" },
        { nombre: "Motorola edge", id: "fix2f6y371azg8fwswcd" },
        { nombre: "iPhone 17", id: "ct77tvoq0niyfq4wai8e" },
        { nombre: "Samsung Galaxy Watch Ultra", id: "k1nsf8dohydcd0nn6whj" },
        { nombre: "Tablet 10.1\"", id: "k1tbnubjahpwcqo0tovc" },
        { nombre: "Sony WH-1000XM6", id: "ov0grqjnsjhos3pwihtj" }
    ];

    const contenedorPrincipal = document.getElementById('pantalla-reels');

    listaProductos.forEach((p, i) => {
        const bloque = document.createElement('div');
        bloque.className = 'contenedor-reels';
        // Agregamos &controls=true para que el usuario pueda quitar Loop o Mute
        bloque.innerHTML = `
            <div id="video-area-${i}" class="reproductor"></div>
            <div class="info"><h2>${p.nombre}</h2></div>
            <a href="#" class="boton-compra">ðŸ›’ COMPRAR AHORA</a>
        `;
        contenedorPrincipal.appendChild(bloque);
    });

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            const i = entry.target.dataset.index;
            const idVideo = entry.target.dataset.id;
            const area = entry.target.querySelector('.reproductor');

            if (entry.isIntersecting) {
                // Insertamos el iframe SOLO cuando estÃ¡ en pantalla
                // quitamos autoplay para que el usuario le dÃ© Play manual
                area.innerHTML = `<iframe src="https://player.cloudinary.com/embed/?cloud_name=dgdw8fbku&public_id=${idVideo}&autoplay=false&controls=true" allow="autoplay; fullscreen" style="width:100%; height:100%; border:none;"></iframe>`;
            } else {
                // Borramos el iframe al salir de pantalla. CERO RUIDO.
                area.innerHTML = "";
            }
        });
    }, { threshold: 0.5 });

    document.querySelectorAll('.contenedor-reels').forEach((div, index) => {
        div.dataset.index = index;
        div.dataset.id = listaProductos[index].id;
        observer.observe(div);
    });
</script>

</body>
</html>
